import{c as v,u as f,r as p,A as N,j as e}from"./index-CHKk25vh.js";import{m as C}from"./mockTestCases-C5YFZIcg.js";import{m as w}from"./mockTestCaseDetails-X7_jjNS1.js";const S=a=>{const t=C.find(c=>c.id===a);return t?{...w,id:t.id,title:t.title,priority:t.priority,type:t.type,suite:t.suite}:null},u={action:"",expected:""};function E(){const{id:a}=v(),t=f(),{user:c}=p.useContext(N),[h,x]=p.useState(!1);if(c.role==="tester"||c.role==="read-only")return e.jsx("div",{className:"text-red-600",children:"You do not have permission to access this page."});const[l,o]=p.useState({title:"",description:"",priority:"Medium",type:"Functional",suite:"",preconditions:"",steps:[{...u}]}),n=s=>{o(i=>({...i,[s.target.name]:s.target.value}))},m=(s,i,r)=>{const d=[...l.steps];d[s][i]=r,o(y=>({...y,steps:d}))},b=()=>{o(s=>({...s,steps:[...s.steps,{...u}]}))},j=s=>{o(i=>({...i,steps:i.steps.filter((r,d)=>d!==s)}))},g=s=>{s.preventDefault(),console.log("Submitting test case:",l),t("/testcases")};return p.useEffect(()=>{a&&(x(!0),setTimeout(()=>{const s=S(a);if(!s){alert("Test case not found"),t("/testcases");return}o({title:s.title||"",description:s.description||"",priority:s.priority||"Medium",type:s.type||"Functional",suite:s.suite||"",preconditions:s.preconditions||"",steps:s.steps&&s.steps.length>0?s.steps:[{action:"",expected:""}]}),x(!1)},500))},[a,t]),h?e.jsx("div",{className:"text-slate-500",children:"Loading test case..."}):e.jsxs("div",{className:"max-w-4xl space-y-6",children:[e.jsx("h1",{className:"text-2xl font-semibold text-slate-800",children:a?"Edit Test Case":"Create Test Case"}),e.jsxs("form",{onSubmit:g,className:"space-y-6 rounded-xl border bg-white p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Title"}),e.jsx("input",{name:"title",value:l.title,onChange:n,required:!0,className:"w-full rounded-lg border px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Suite"}),e.jsx("input",{name:"suite",value:l.suite,onChange:n,className:"w-full rounded-lg border px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Priority"}),e.jsxs("select",{name:"priority",value:l.priority,onChange:n,className:"w-full rounded-lg border px-3 py-2",children:[e.jsx("option",{children:"Critical"}),e.jsx("option",{children:"High"}),e.jsx("option",{children:"Medium"}),e.jsx("option",{children:"Low"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Type"}),e.jsxs("select",{name:"type",value:l.type,onChange:n,className:"w-full rounded-lg border px-3 py-2",children:[e.jsx("option",{children:"Functional"}),e.jsx("option",{children:"Regression"}),e.jsx("option",{children:"Integration"}),e.jsx("option",{children:"Smoke"}),e.jsx("option",{children:"UI"}),e.jsx("option",{children:"API"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Description"}),e.jsx("textarea",{name:"description",value:l.description,onChange:n,rows:"3",className:"w-full rounded-lg border px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Preconditions"}),e.jsx("textarea",{name:"preconditions",value:l.preconditions,onChange:n,rows:"2",className:"w-full rounded-lg border px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-medium text-slate-800 mb-2",children:"Test Steps"}),e.jsx("div",{className:"space-y-3",children:l.steps.map((s,i)=>e.jsxs("div",{className:"rounded-lg border bg-slate-50 p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1",children:"Action"}),e.jsx("textarea",{value:s.action,onChange:r=>m(i,"action",r.target.value),rows:"2",className:"w-full rounded border px-2 py-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1",children:"Expected Result"}),e.jsx("textarea",{value:s.expected,onChange:r=>m(i,"expected",r.target.value),rows:"2",className:"w-full rounded border px-2 py-1"})]})]}),l.steps.length>1&&e.jsx("button",{type:"button",onClick:()=>j(i),className:"mt-2 text-xs text-red-600 hover:underline",children:"Remove Step"})]},i))}),e.jsx("button",{type:"button",onClick:b,className:"mt-3 text-sm text-blue-600 hover:underline",children:"+ Add Step"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>t("/testcases"),className:"rounded-lg border px-4 py-2 text-sm",children:"Cancel"}),e.jsx("button",{type:"submit",className:"rounded-lg bg-blue-600 px-4 py-2 text-sm text-white hover:bg-blue-700",children:a?"Update Test Case":"Create Test Case"})]})]})]})}export{E as default};
